# import base64
# import hashlib
import json

from josepy.b64 import b64decode

# from josepy.jwk import JWK
# from josepy.jws import JWS, Header

tok = bytes(
    "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJSQWZ1VUdMZ0dnbzIyOHlDZ3BaTzdVa21pdWdvN3dBUFFCREM5akJqdmhjIn0.eyJqdGkiOiIzZWViYjE4MC0xNTk2LTRlM2MtOGIyNy05YTdhM2U5MzY4ODIiLCJleHAiOjE1NjM4ODcyNDQsIm5iZiI6MCwiaWF0IjoxNTYzODg2MzQ0LCJpc3MiOiJodHRwOi8vbG9jYWxob3N0L2F1dGgvcmVhbG1zL0hpZGFsZ28iLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiZDczNGFkN2EtOTRkZS00OGUzLTg5MmItMmQ0NGI5M2JmNWFlIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiZnJvbnRlbmQiLCJhdXRoX3RpbWUiOjE1NjM4ODYzNDQsInNlc3Npb25fc3RhdGUiOiI5MjhlZGExYy1hZWQ0LTQ0ZWEtODA4ZC1kNjk4MWQ0MTgwNzQiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly9sb2NhbGhvc3Q6NDIwMCJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJEZXZlbG9wZXIiLCJ1bWFfYXV0aG9yaXphdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoicm9sZXMgcHJvZmlsZSBlbWFpbCIsImVtYWlsX3ZlcmlmaWVkIjp0cnVlLCJuYW1lIjoiSmF2aWVyIENhcm5lcm8iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJqY2FybmVybyIsImdpdmVuX25hbWUiOiJKYXZpZXIiLCJmYW1pbHlfbmFtZSI6IkNhcm5lcm8iLCJlbWFpbCI6Imphdmllci5jYXJuZXJvQGF0b3MubmV0In0.JU-mkAY0lIt2pI5yMf9GBhP7Q-7EHdHqKSnJkGkg-S2QdPdCBiRHyl5RyWpxeuJ4Vv6qxhkKjKv7O3Pe_5p35wbUzM5sNdmaScQ2uX8MV3ibFIMN4DTw-d4j14IQjUspHr3SXf4bx0r60zRLRB7rNf-0-fFyQ01Lj1349yWtREXPQZha27UdE-RbCQCl4Jsz-vYFNvFae9wKHCjTvZu7dBRDNjVIvLnzXaAyCrjmZs__COC6nsuO30VB9S9JEPQzqvOQ3LbvxAQKNchOUyHiTJJoEM8BR1GEryIjjteEWgezmuryeBpvWQ6Ee3lVckWuyHv8Tr--zAMuwHUiU5udQw",
    "utf-8",
)

header, payload_data, signature = tok.split(b".")
header = json.dumps(json.loads(b64decode(header)), indent=4, sort_keys=True)
payload = json.dumps(json.loads(b64decode(payload_data)), indent=4, sort_keys=True)

print("Header: ", header)
print("Payload: ", payload)
print("Signature: ", str(signature))
